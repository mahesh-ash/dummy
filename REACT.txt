const dynamicExtraFields = [
  {
    name: "extra_field_1",
    label: "Reference Name",
    placeholder: "Enter reference name",
    type: "string",
    mandatory: true,
    pattern: /^[A-Za-z ]+$/,
    patternMessage: "Only alphabets allowed",
    readOnly: false,
    defaultValue: "ABC Corp",
  },
  {
    name: "extra_field_2",
    label: "Description",
    placeholder: "Enter description",
    type: "string",
    mandatory: false,
    readOnly: true,
    defaultValue: "Auto-generated description",
  },
  {
    name: "extra_field_3",
    label: "Discount %",
    placeholder: "Enter discount",
    type: "number",
    mandatory: true,
    pattern: /^\d+(\.\d{1,2})?$/,
    patternMessage: "Max 2 decimal places allowed",
    readOnly: false,
    defaultValue: 10,
  },
  {
    name: "extra_field_4",
    label: "Tax Amount",
    placeholder: "Enter tax amount",
    type: "number",
    mandatory: false,
    readOnly: true,
    defaultValue: 5,
  },
];const dynamicDefaultValues = dynamicExtraFields.reduce((acc, field) => {
  acc[field.name] = field.defaultValue ?? (field.type === "number" ? undefined : "");
  return acc;
}, {} as Record<string, any>);const form = useForm({
  defaultValues: {
    ...existingDefaultValues, // your current form values
    ...dynamicDefaultValues,
  },
});const getValidationRules = (field: any) => {
  const rules: any = {};

  if (field.mandatory && !field.readOnly) {
    rules.required = `${field.label} is required`;
  }

  if (field.pattern) {
    rules.pattern = {
      value: field.pattern,
      message: field.patternMessage || "Invalid format",
    };
  }

  return rules;
};<div className="col-span-3 grid grid-cols-2 gap-6">
  {dynamicExtraFields.map((item) => (
    <FormField
      key={item.name}
      control={form.control}
      name={item.name}
      rules={getValidationRules(item)}
      render={({ field }) => (
        <FormItem>
          <FormLabel className="font-medium">
            {item.label}
            {item.mandatory && !item.readOnly && (
              <span className="text-red-500">*</span>
            )}
          </FormLabel>

          <Input
            {...field}
            type={item.type === "number" ? "number" : "text"}
            placeholder={item.placeholder}
            className={`h-11 ${item.readOnly ? "bg-gray-100 cursor-not-allowed" : ""}`}
            readOnly={item.readOnly}
            onChange={(e) =>
              item.readOnly
                ? undefined
                : item.type === "number"
                ? field.onChange(
                    e.target.value === "" ? undefined : Number(e.target.value)
                  )
                : field.onChange(e.target.value)
            }
          />

          {/* prevent UI jerk */}
          <div className="min-h-[20px]">
            <FormMessage />
          </div>
        </FormItem>
      )}
    />
  ))}
</div>
