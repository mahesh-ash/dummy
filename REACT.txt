const dynamicRowFields = [
  {
    name: "dyn_code",
    label: "Code",
    placeholder: "Enter code",
    type: "string",
    mandatory: true,
    pattern: /^[A-Z0-9]+$/,
    patternMessage: "Only uppercase letters & numbers allowed",
    readOnly: false,
    disabled: false,
    defaultValue: "",
    className: "",
  },
  {
    name: "dyn_description",
    label: "Description",
    placeholder: "Enter description",
    type: "string",
    mandatory: false,
    readOnly: false,
    disabled: false,
    defaultValue: "",
    className: "",
  },
  {
    name: "dyn_quantity",
    label: "Quantity",
    placeholder: "Qty",
    type: "number",
    mandatory: true,
    pattern: /^\d+$/,
    patternMessage: "Only numbers allowed",
    readOnly: false,
    disabled: false,
    defaultValue: 0,
    className: "",
  },
  {
    name: "dyn_amount",
    label: "Amount",
    placeholder: "Amount",
    type: "number",
    mandatory: false,
    readOnly: true,
    disabled: true,
    defaultValue: 100,
    className: "bg-gray-100",
  },
];const dynamicRowDefaults = dynamicRowFields.reduce((acc, field) => {
  acc[field.name] =
    field.defaultValue ??
    (field.type === "number" ? undefined : "");
  return acc;
}, {} as Record<string, any>);

const form = useForm({
  defaultValues: {
    ...existingFormDefaults, // your current form defaults
    ...dynamicRowDefaults,
  },
});const getDynamicRules = (field: any) => {
  const rules: any = {};

  if (field.mandatory && !field.readOnly && !field.disabled) {
    rules.required = `${field.label} is required`;
  }

  if (field.pattern && !field.disabled) {
    rules.pattern = {
      value: field.pattern,
      message: field.patternMessage || "Invalid format",
    };
  }

  return rules;
};{/* ðŸ”¹ Dynamic 4-Field Row (Ticker Style) */}
<div className="col-span-3 bg-gray-50 dark:bg-gray-800 rounded-lg p-4 grid grid-cols-4 gap-4 mb-4">
  {dynamicRowFields.map((item) => (
    <FormField
      key={item.name}
      control={form.control}
      name={item.name}
      rules={getDynamicRules(item)}
      render={({ field }) => (
        <FormItem>
          <FormLabel className="font-medium">
            {item.label}
            {item.mandatory && !item.disabled && (
              <span className="text-red-500">*</span>
            )}
          </FormLabel>

          <Input
            {...field}
            type={item.type === "number" ? "number" : "text"}
            placeholder={item.placeholder}
            readOnly={item.readOnly}
            disabled={item.disabled}
            className={`h-10 ${
              item.readOnly || item.disabled
                ? "bg-gray-100 cursor-not-allowed"
                : ""
            } ${item.className}`}
            onChange={(e) =>
              item.readOnly || item.disabled
                ? undefined
                : item.type === "number"
                ? field.onChange(
                    e.target.value === ""
                      ? undefined
                      : Number(e.target.value)
                  )
                : field.onChange(e.target.value)
            }
          />

          {/* prevent UI jerk */}
          <div className="min-h-[18px]">
            <FormMessage />
          </div>
        </FormItem>
      )}
    />
  ))}
</div>
