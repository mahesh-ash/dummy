use SQLTraining;

GO
IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'Ecommerce_Website')
BEGIN
    EXEC('CREATE SCHEMA Ecommerce_Website');
END;
GO

go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'M_S_USER' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.M_S_USER (
    user_id INT IDENTITY(1,1) PRIMARY KEY,
    fullname VARCHAR(28) NOT NULL,
    email VARCHAR(28) UNIQUE NOT NULL,
	phone varchar(20) NOT NULL,
    password VARCHAR(255) NOT NULL,
	address varchar(255) NOT NULL,
	pincode int not null,
    is_active bit default 1,
    createdat DATETIME DEFAULT GETDATE(),
	updatedat DATETIME DEFAULT GETDATE(),
);
END;
go

go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'M_S_ADMINS' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.M_S_ADMINS (
  admin_id INT IDENTITY PRIMARY KEY,
  username VARCHAR(50) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
);
END;
go







ALTER TABLE M_S_USER ADD status BIT DEFAULT 1; -- 1 = active, 0 = deactivated


select * from Ecommerce_Website.M_S_USER with (nolock);


go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'M_S_CATEGORY' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.M_S_CATEGORY (
    category_id INT IDENTITY(1,1) PRIMARY KEY,
    category_name VARCHAR(28) NOT NULL,
    description VARCHAR(28) UNIQUE NOT NULL,
	createdat DATETIME DEFAULT GETDATE()
);
END;

ALTER TABLE Ecommerce_Website.M_S_CATEGORY
ALTER COLUMN description varchar(100) not null;


go

INSERT INTO Ecommerce_Website.M_S_CATEGORY (category_name, description)
VALUESÂ 
('Mobiles', 'Smartphones and accessories'),
('Laptops', 'Laptops for work and play'),
('TVs', 'LED and Smart TVs'),
('Speakers', 'Bluetooth and home speakers');



select * from Ecommerce_Website.M_S_CATEGORY with(nolock);

go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'M_S_DATAS' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.M_S_DATAS (
    product_id INT IDENTITY(1,1) PRIMARY KEY,
	category_id int not null,
    product_name VARCHAR(28) NOT NULL,
    description VARCHAR(100) UNIQUE NOT NULL,
	price decimal(10,2) not null,
	stock int not null,
	image varchar(255) not null,
	createdat DATETIME DEFAULT GETDATE(),
	updatedat DATETIME DEFAULt GETDATE()
);
END;


GO

INSERT INTO  Ecommerce_Website.M_S_DATAS(category_id, product_name, description, price, stock, image)
VALUES
(1, 'iPhone 15 Pro', 'A17 Pro Chip, 256GB', 129999, 15, '/Ecommerce_Website/Assets/iphone.jpg'),
(1, 'Samsung Galaxy S24', 'Snapdragon 8 Gen 3, 128GB', 99999, 20, '/Ecommerce_Website/Assets/Samsung.jpg'),
(2, 'HP Laptop 15s', 'Intel i5, 16GB RAM, 512GB SSD', 59999, 10, '/Ecommerce_Website/Assets/Hp.jpg'),
(2, 'Dell Inspiron', 'Ryzen 5, 8GB RAM, 512GB SSD', 54999, 15, '/Ecommerce_Website/Assets/Dell.jpg'),
(3, 'Samsung Smart TV', '4K UHD 55-inch', 49999, 8, '/Ecommerce_Website/Assets/smart Tv.jpg'),
(3, 'Sony Bravia', 'LED 43-inch Full HD', 42999, 10, '/Ecommerce_Website/Assets/Sony.jpg'),
(4, 'JBL Speaker', 'Portable Bluetooth Speaker', 7999, 25, '/Ecommerce_Website/Assets/JBL.jpg'),
(4, 'Sony Speaker', 'Extra Bass Waterproof', 8999, 18, '/Ecommerce_Website/Assets/Sony Speaker.jpg');




INSERT INTO Ecommerce_Website.M_S_CATEGORY (category_name, description) VALUES
  ('Cameras', 'DSLRs, mirrorless, and action cameras'),
  ('Tablets', 'Android and iOS tablets');

  select * from Ecommerce_Website.M_S_CATEGORY with(nolock);


  update Ecommerce_Website.M_S_CATEGORY 
  set category_id=5 where category_name='Cameras';


INSERT INTO Ecommerce_Website.M_S_DATAS (category_id, product_name, description, price, stock, image) VALUES
  (7, 'Sony Alpha ZV-E10', '24MP APS-C, 16-50mm Lens', 69999, 10, '/Ecommerce_Website/Assets/sony_zve10.jpeg')


INSERT INTO Ecommerce_Website.M_S_DATAS (category_id, product_name, description, price, stock, image) VALUES
  (8, 'Apple iPad Air', 'M1 Chip, 10.9-inch, 64GB', 59999, 12, '/Ecommerce_Website/Assets/ipad_air.jpg'),
  (8, 'Samsung Galaxy Tab S9', '11-inch AMOLED, 128GB', 54999, 10, '/Ecommerce_Website/Assets/galaxy_tab_s9.jpg');


INSERT INTO Ecommerce_Website.M_S_DATAS (category_id, product_name, description, price, stock, image) VALUES
  (2, 'HP Pavilion 14', 'Intel i3, 16GB RAM, 1TB SSD', 74999, 8, '/Ecommerce_Website/Assets/hp_pavilion.jpeg'),
  (2, 'Dell XPS 13', 'Intel i4, 8GB RAM, 512GB SSD', 89999, 5, '/Ecommerce_Website/Assets/dell_xps13.jpeg'),
  (2, 'Lenovo ThinkPad E14', 'Ryzen 8, 16GB RAM, 512GB SSD', 69999, 10, '/Ecommerce_Website/Assets/lenovo_e14.jpg');


INSERT INTO Ecommerce_Website.M_S_DATAS (category_id, product_name, description, price, stock, image) VALUES
  (1, 'OnePlus 12', 'Snapdragon 9 Gen 2, 256GB', 69999, 12, '/Ecommerce_Website/Assets/oneplus_12.jpg'),
  (1, 'Vivo X100', 'Dimensity 9307, 512GB', 59999, 10, '/Ecommerce_Website/Assets/vivo_x100.jpg'),
  (1, 'Realme GT 5', 'Snapdragon 5 Gen 2, 256GB', 49999, 15, '/Ecommerce_Website/Assets/realme_gt5.jpg');




select * from Ecommerce_Website.M_S_DATAS;

update Ecommerce_Website.M_S_DATAS
SET image='/Ecommerce_Website/Assets/sony_zve10.jpg' where product_id=47;

update Ecommerce_Website.M_S_DATAS
SET category_id=7 where product_id=10;

go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'D_D_CART' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.D_D_CART (
    cart_id INT IDENTITY(1,1) PRIMARY KEY,
	user_id int not null,
	product_id int null,
	quantity int not null,
	createdat DATETIME DEFAULT GETDATE(),
	updatedat DATETIME DEFAULT GETDATE()
);
END;
go


select * from Ecommerce_Website.D_D_CART with(nolock);


use SQLTraining
DELETE  FROM Ecommerce_Website.M_S_DATAS where product_id=54 ;
select *  FROM Ecommerce_Website.M_S_DATAS ;

go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'D_D_ORDER' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.D_D_ORDER (
    order_id INT IDENTITY(1,1) PRIMARY KEY,
	user_id int not null,
	total_amount decimal(10,2) not null,
    orderdate DATETIME DEFAULT GETDATE(),
	status varchar(30) default 'Pending'

);
END;
go

use SQLTraining;
select  * from Ecommerce_Website.D_D_ORDER with (nolock);



go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'D_D_ORDERLOGS' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.D_D_ORDERLOGS (
    id INT IDENTITY(1,1) PRIMARY KEY,
	order_id int not null,
	product_id int not null,
	quantity int not null,
	price decimal(10,2) not null,
    total decimal(10,2) not null

);
END;
go

select * from Ecommerce_Website.D_D_ORDERLOGS WITH(nolock);

go
IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = 'D_D_LOGS' AND schema_id = SCHEMA_ID('Ecommerce_Website'))
BEGIN
CREATE TABLE Ecommerce_Website.D_D_LOGS (
    log_id INT IDENTITY(1,1) PRIMARY KEY,
	user_id int not null,
	total_amount decimal(10,2) not null,
	action varchar(30) not null,
    timestamp DATETIME DEFAULT GETDATE()

);
END;
go


